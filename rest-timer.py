#!/bin/python3
import tkinter as tk
from tkinter import messagebox
from tkinter import ttk
import re

timer_btn_color = '#00bc00'
id = None
APP_TITLE = 'Rest Timer'

ICON_BYTES = b'\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x002\x00\x00\x002\x08\x06\x00\x00\x00\x1e?\x88\xb1\x00\x00\x08\xc3IDATx\x9c\xedX}l\x95\xd5\x19\xff=\xcfy\xdf\xf7\xf6\x0b\xdaR(\x96\xd2\x0f\xb0\x02^\xdaR\xbdQ\x08\xb4\xbdTt\x12\x99\xa2\x08\xba0u\xd1%&\x9a\xe9\xa23\xc4e\xa0\x89nq\x8b\xe8\x983\x99\x8b\x8bN\x8dQ3?7\x99\xe2\x07R\xdb*\xccU\x85\xc2\x05\xb5Ho\x01\x19\x1f\x95\xaf\x96\xf6\xde\xf7=\xcf\xb3?@\xd7\xb1\xaa\xbd\x97vnI\x7f\xc9\xfd\xe7>\xe7\xfc\x9e\xdf\xef\x9c\x93\xf3<\xe7\x05F0\x82\x11\x8c\xe0\xff\t4\x8c\xdc\xa6hJ$_\xc5~\x99cjq\xee\xc1\xc6\xc6\xc6`8\x92\r\x8b\x91H$\xe2v%\xb3\x7f\xe3+-\x84\xaa\x02\x040\xb1CX=\xd6=zckk\xab?\xd49\x9d\xa1&\x04\x80Pqq\x86v\x1c\xbd\x84\x8d3\x01"\x00\x14`\x07j\xfd\x8b\xc6\x8d\x1b\x97\t`\xc8\x8d\x0c\xdb\xd1\x9a4\xe3\xbc\x1fY\xc5b\x11\xa9U\x02\x0cq\x13\xb3\xbc\xd0\xf1\xe1\xba\x07\x86#\xdf\x90\x1b)\xad\xae\x9b$\x16\xf3@t6\x11\x9f\xa9\xa0\xb9 \x02\x03o\xc3j\x0c\x8a\x0f<J\xbc\xd9\xbe\xe5\x9d\xedC\x99w\xc8\x8c\x94M\x9dY\xae&\xf4ca\xe7*v\x9c\xb1P\x85\x88\x9f\x80\xe2sUQf\x93\x0f\xe6L\x82\x81\x88\x7f\x08\xa2O\xab\xf4\xde\xbf{\xeb\x86O\x86"\xff\x90\x18)\xab\x9cs\x99\x85w\x1f;\xce$\x11\x7f/\x14\xcf{,\xaf\xbb\xae\x89\x89\xdf\xdb\xdd\xd7\x97\xd0QY\xa3\xb3\xbaE\xa6\xc2\xd2<\x90Y\x0c\xe3\x96\xa8\xf8\xbbXeY\xbc\xad\xf1\xa9o\xdd\xc8\xe4\x9a\x86\x1b|\xa1_+(D\xb0\x0ff\xc2\xde\xff\xf1\xa6\xa6\x1d\xff2Y\x7f+\x0c\xe7\xc57\xae\xbb\xe3\x8b\xff*\xaa\xce\x9d\xe8k\xc6\xcd\x96\x9c[\x88@\xac\xfem\xf1\xb6\xa6U\xdf\x9a\x91\xb2\xe9\xb5\xdf\x13\'\xf4\x18\x14\th\xf2\xa6\x9dmM\x8f\x9d<fbU\xf41cxL\xfc\xc3\xb7.>9VZU\xbbX\xc9}\x08\xcay$\x89k;\xb74?\x91\xae\x16Nw\xe2\xd4\xaa\xd9S\x85\x9dU\xaa\xaa\x8c\xc4\xf5\x03\x99\x00\x80\x10\xe1)"\xfb\xf0@\xb1\xce\xb6\xe6g\x81\xe4\xb5 MXv\xef+9s\xce\xf4t\xf5\xa4\x0b*\xa9\xac\x7f\xbc\xb4\xe6B\x9dX\x1d\xfd\x05\x00\x94\xcd\x88\xe6\x95W\xd7\xdf\\1}\xf6\xe9\xa9\x92\x95WE\x97\x97\xd6|G\'VF\x9f\xbe3\xcd\xc5MkRyMC\xb5\x90\xb3\x18A\xf2\x13\x04\x89\xfb\x00@\xc5\x8e\t\x84\xeeJ\x98\x8c\xd5e\xe1\xd95\xa9\xf0\x15x\xdd\xbf\x85Mn&6\x97=>\xbd>\x92\x8e\xa6\xf4\x8e\x96\xd8\x85\xc6\x98LP\xf0\xf8\xae\xd8\xfa\xcfq\xfc\x98|J*W@\xb5\xc0\x9a\xd0\xea\x92is.\x18,]kk\xeba\x82>B\xecx\xd6\xe8\xa5\xe9HJ\xd9\xc8\x12,1\x02\xaeS\x1bX\x11Z\xd3?\xb6sK\xd3k$\xbd\x972\xb3\xc0\xcbx\xae\xb4\xb2\xee\xfb\x83\xe5Uc\xd7\x88\xf5\x13\x80S\x07DSn\x9dR6\xf2\xb7\x19\xfbF\xa9`\x8a\xa8\xee-p\xe8?\x8aY\xe7\x96\xf5-\xd9..!\xe8^\x0b\xe7\xd1\x92\xca\xb9O\x96VE\x97O\xaa\x9c9\xfe\xebx\xc7\x99\xde\x0eR\xdd)\x8a3\xa6LA^\xaa\xbaRv\x9e\x9d\xe3\x8e>z\xc4\x8e!\xd6\x8f\x8fj\xd2+\xabn\xb8A\x89\x0cd\xff\x93\x9dmm\x07\x01`\xeb\xdf\xdf\xfc\xa04\\\xbb\x90\x8c\xbb\x1a\xec.U\x02\x02\xab\x85\x00n\xee\xcf\x15\x89\x9c\x9f{(\x90\xabEHz\x18\xcf\xb0\xd1\xdd\xd6\xea9&\x9b\xb3\x01\x1cHEW\xca;b\x03\xc3\n0+\x05\x0e\x9cl\xa84\xa8\xd8\xf3\x02\t\xe5\xf4\x1f\xd7\x19k\x8e\xb1\xea:"\x02\x1d/X\xe3N\xe6:\x12H\x8e/\xb6A\xd46\x18Mf)\xb1\x10)D$\xe5\xfa\x96\xf2\x8e\xf8,\xc7\x08\xe8\x11\xd1BGx\xff\xc7\xb1\xc6+N\x14V=y\xacA\xf0kk\xa9\x88\x08\xc6\x81\xac<9\xfe\xc9\xc6\xb5\xbb\x01\\\x0e\x80\x8a\x8a"\x99\xa6\x80\'\x10s_\xce\xe8Pb\xd8\x8dd\x1c\xde}(0\x85;\x941\xc3w\xb5\x04\xc0\xd6\x81L\x00\xc0\x8e\xcd\xcd\x9b\x96\x00\x0b\xf6EA\x8d\x8d\xf8\xba\x97\xa1f\x9d\x963!\x19P\x89\xaa~t\xa0s\xdb\xc1Tu\xa5|\xb4b\xb1X\x12\xa4\xef2\xbb\xa1>Ks\xbfi\xfc\x9f\x00\xfb\r&\x00\x00~R\xa2d\x9c,\x06\xd6\xc7\xe3\xf1\xbeTu\xa5UG\x88\xf4%\x15\x11\x88^SQ1?\x94\x0eG\x7fD"\x11\x17d\xaeQQ0\xd9\x97\xd2\xe1H\xcbH\xb6\x7f\xa0\x85T\xd6\x92\xf1f%3{\xafN\x87\xa3?\xba\x92YKa\x9cz\x12\xdb\xecL\xd8\xb3.\x1d\x8e\xb4\xbb\xdf\x92\xea9\xb5\x90\xd0\x1a\xb0\x1e\xf54\xb8h{[\xd3\xfb\x03\x8d+\xaf\x9a=UU)\xbe\xf9\xddm\x03\xc5\xcb\xc2\xb3k\xc4\x84\xfe\xaaD\x05\x8e\xf5/\xee\xd8\xd2\xf4Z:z\xd2\xee~wnjif\xd8\xbb\x89\x9c\xf1I\x98\xa7O?\xbbv\xc0\x1eI\xe0-\x83\x86~6P\xac\xb4\xaa\xeelK\xee3d\x9c"\x16\xbb2]\x138\x15#\x00P\xbe\xb9q\xa5\xd8\xc4*\xb0{F2\xf0^.\xab\xac\xbf.\x1c\x0e{\xfd\xc7\x10\xd0C\xac\xffv\x9dVTT\x84J\xa7\xd7\xfdP\xc9[\xcd\xae7\x056\xf9{\xaf/\xf3\xaeS\xd1r\xca/\xc4%\x80\xd9PU\xf7S%w\x05\x91\xf1\xa0A#i\xf0G\x0f\xfav\xef\xc1\x8e=\xa3\x8bN\xcf\xf5\x93\t\xd3\xdb\x85\xcf)\x97\'(9Q\x02\xff\x00\xc6\xa9\x87h\xc0\xb0\xf7d\xdb}?\x8f\xc5b\xc9o\xd5\xc8\x17\x98\\U;\xcf\x87\xbb\x02\xc4Q"\x86\x88\xed&\xb1\x9f\x12s\x1c\xa4\x8e\nJT1\x89\\7\x1b\xa2P\x04M.\xfbw\xef\xf8\xb0\xe5\xf5\xa1\xc8?\xa4\x9f\x83***B\xc9\x8c\xa2\xf3A\xbcH\xc1\xe7*\xb4\x9c\x88\xb2\xa0\xaa\xa2\xda\xed0oW\xc8{\x90\xe4_\xbc\xbe\xfdo\xb4\xb7\xb7\xa7\\\xc1\xbf\n\xc3\xf6\x81.\x12\x89d\x1d\xec\xcd\x18\x9b\x91\x13\xca!?\xd0\xa4$\x8f$\x0f\x85\xba\xe2\xf1\xc6\x94\x8b\xdd\x7f\x15:\xf4\x8b\x92\xd2E4\xe8\xe4\x953\xcf\x1b\x7f\xa4\'\xf8\x95U\xcd7d\x00E\x0bu\xeb\x03\x92\xe3\x17\xb3\xf1\xeeQ\xc1(\xb0&\tx5\xbe\xa9\xf1\xa1\x92i3\xcf\'7\xf3F\xa8\x86@dH\x93/\xc47\xbf\xf3\x10\x00\x94UGo\x00\xf1<\xe0\xd8m\xf1\x8d\x1b:.\xb8\xe0\xaa\xec\xed\xfbv\xaf\xb2I\xfb||\xeb\xdb\xaf\x94WE\x97C\xb5\xc0\xe9\xcb\xba\xbd\xbd\xfd\xd5A\x1d\xbfA\xbbv3\xb2G);W\xc2\xdaD\x10\xf8\xdb\x94i\x85\xe6\xd2\xf5d9O\x94\x16\xa9J\x97\x04\xb2[\xd4\xdc_Z9w\xa9\xcf\xded%^`m\xb05H&Z\x03k;\x01`r$\x92\xabJ?Q\xf6.W\xf5\x16\x03\x00\xe5%B\xc2\xbc\xc8\x12O.\xab\xae\xbf\xce\x82\x963\x9b\xa6\xf6\xf6W\x07}\x93\r\xda\x08\xb3\xafD\xe8\xb5\xc0\xbbj\xfd\x97E\x82\x03Pd\xfa %\xa2\xee\x82ls\xef\xaeX\xd3\x8d \xddID\xb3HH\x89\xa8+\xc3\xf3\x1e\xc9\x0c\xfc\xdf9\x85\x19k\x01@\x92\xd9Q\x012a{_T\x98E\x88F\x9d\xdc\xfc|\x0b\xa2\xc3\xc42_\xc4\xfc\x92To\xfbt\xd3[\xcf\x7fUW}JF\x92\xbeQUac\xdc\xdb9\x94\xf1\x04\xb1S\x0c\t>s]\x1f\xaa\xeau\x1d\x93\x87\x8b\xc3\xf5-P\x19\xc3\x90\x97@jU\xb40\xe1\xdb\xb5\x89\x8c\xac\xf7\xdcCr9\x00(\xd1\x15\x04\xdd\xe0XY\t\xa5\xf0\xc4\xc3zV>\xe0CA`\xef\xbb`\x8c\x05\xa3c\xb0\xbaR6\xe2\x18\x9f\x15\xa4*\x89\x9b$\xd4\x13\x86\xca+\xca\xe6&\xf11J\x81\x80\xd4\xbeOL\xc5\xaa\xda\xbc\xa3\xad\xf1\r(2\x99y\x7f\xa6K\x17\x9a 1\x0b={\x9e\x9dT9s\xbc(\xcfSE\x8dOXA\xa0\\\x04\xb4\xf0D\nW%\xf1g\xc0>\xa7J\xf7\x86\'\xce\x1a\x93\x8a\x91A?\xacT\x85\x18\x08\x81\xdc\x05\xc6\xcf(\xb1\x84\x19\xaa\xbaQ4\xf0\x1d\x80O\xcb\xcfy`\xef\xe1\xdeF\x01?ZV]\x7f\x96\xef\x8bUH^ \xb4\x80\xddP_\xc2\x1d\xbf\x89\xd9\x94@5\xd7J\xf0\x84\nu;\xc6\xba\xc4t\xe5\xc6\x8f\xe2\x7f\x80\xaa\x11\xa55\xa3\x8c\xf7bO\x10\xc4\x8e\xe4\x85\xee\xc0.\xdc\n@\x06\xa3o\xd0;B\x01zH\xa5\x89\x98\xa7\xa9`1\x03kI\xfd[3\x8d\xb3\xcf\x18Z\xdf\xe3\x07Z>\x06/\x10t5D\x1a\x08~\\DZ\x03\xc5Ba^j`f\x93h1\x93<\xb8\'\xd6\xb2\xec\x1f\xdb\x9a\xefr\xc9\xdeB@\xfb\xbe\xfd\xc7\nE\x82\xb5N\x10\xec\xfd\xe8\x837>c\xc82\x86N+\x0b\x9fS8X})!\x12\x89\xb8\xe1p\xd8\x8bD"n\x7f\x8f\x15\xf3\xe7\x87\xfa]\xe5|\xa2q\xa4p8\xec\x85\xc3a\xaf\xa2\xa2"\x04,1\'\xcd;\x8e(\x1c\x00\xe6\xc4\xef\xcb\x85=\xceq\xe7)5\xb5#\x18\xc1\x08F\xf0\xbf\x8b\x7f\x02\x84\xa0\x010{1\x9c\x91\x00\x00\x00\x00IEND\xaeB`\x82'


def rest_message():
    messagebox.showinfo(title=APP_TITLE, message='You should rest')
    start()

def stop():
    global timer_btn_color
    timer_btn.config(bg = '#00bc00', text='Start Timer', command=start)
    timer_btn_color = '#00bc00'
    window.after_cancel(id)

def start():
    global id, timer_btn_color
    try:
        time = int(minutes_var.get() * 60 * 1000)
    except:
        messagebox.showerror(title = APP_TITLE, message = 'Invalid time')
    else:
        timer_btn.config(bg = '#ff1629', text='Stop Timer', command=stop)
        timer_btn_color = '#ff1629'
        id = window.after(time, rest_message)

window = tk.Tk()
window.title(APP_TITLE)

# --- Application icon ---

icon = tk.PhotoImage(data=ICON_BYTES)
window.iconphoto(True, icon)

# --- Application Main Frame ---

frm = tk.Frame(bd=5)
frm.pack()

minutes_lbl = tk.Label(frm,text = 'Time in minutes:')
minutes_var = tk.DoubleVar(value = 20)

# --- Start/Stop Timer button

is_number_register = window.register(lambda text : True if re.fullmatch(r'[\d\.]*', text) and text.count('.') < 2 else False)
minutes_entry = ttk.Spinbox(frm,textvariable = minutes_var, validate='key', validatecommand=(is_number_register, '%P'), from_=0,to=float('inf'))
timer_btn = tk.Button(frm,text='Start Timer', bg = '#00bc00', command=start, cursor='hand2')

minutes_lbl.grid(row = 0, column = 0)
minutes_entry.grid(row=0,column=1,padx=5)
timer_btn.grid(row=0,column=2)

timer_btn.bind('<Enter>', lambda event : timer_btn.config(bg='#9fbc00' if timer_btn_color == '#00bc00' else '#ff8629'))
timer_btn.bind('<Leave>', lambda event : timer_btn.config(bg='#00bc00' if timer_btn_color == '#00bc00' else '#ff3629'))

# --- This launchs the program ---

window.mainloop()
